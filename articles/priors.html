<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fdmr">
<title>Priors exploration • fdmr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Priors exploration">
<meta property="og:description" content="fdmr">
<meta property="og:image" content="https://4dmodeller.github.io/fdmr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fdmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="../articles/getting_started.html">Installation</a>
    <a class="dropdown-item" href="../articles/data_preprocessing.html">Data pre-processing</a>
    <a class="dropdown-item" href="../articles/expected_data_structure.html">Expected data structure</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>End to end tutorials</h6>
    <a class="dropdown-item" href="../articles/decision_tree.html">How to choose how to model</a>
    <a class="dropdown-item" href="../articles/simulation_gaussian_data.html">Simulation Tutorial (Gaussian data)</a>
    <a class="dropdown-item" href="../articles/simulation_poisson_data.html">Simulation Tutorial (Poisson data)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Shiny apps</h6>
    <a class="dropdown-item" href="../articles/meshbuilder.html">Mesh building</a>
    <a class="dropdown-item" href="../articles/modelbuilder.html">Model builder</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>In depth tutorials</h6>
    <a class="dropdown-item" href="../articles/covid.html">COVID-19</a>
    <a class="dropdown-item" href="../articles/covid_mcmc.html">COVID-19 MCMC</a>
    <a class="dropdown-item" href="../articles/covid_ST_mcmc.html">COVID-19 MCMC (Space-time)</a>
    <a class="dropdown-item" href="../articles/hydro.html">Hydrology</a>
    <a class="dropdown-item" href="../articles/priors.html">Priors exploration</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>FAQ</h6>
    <a class="dropdown-item" href="../articles/inla_FAQ.html">INLA Crash FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://4dmodeller.github.io/4DM_Hackathon/">Hackathon</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/4DModeller/fdmr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="priors_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="priors_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="priors_files/leaflet-1.3.1/leaflet.js"></script><link href="priors_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="priors_files/proj4-2.6.2/proj4.min.js"></script><script src="priors_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="priors_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="priors_files/leaflet-binding-2.2.1/leaflet.js"></script><script src="priors_files/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="priors_files/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Priors exploration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/4DModeller/fdmr/blob/HEAD/vignettes/priors.Rmd" class="external-link"><code>vignettes/priors.Rmd</code></a></small>
      <div class="d-none name"><code>priors.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="aim-and-data-description">Aim and data description<a class="anchor" aria-label="anchor" href="#aim-and-data-description"></a>
</h2>
<p>In this tutorial we’ll show an example of exploring the impact of
different priors for the spatial and temporal autocorrelation parameters
on the model inference results obtained from the INLA-SPDE approach. A
Bayesian spatio-temporal model with different priors will be fitted to
the COVID-19 infections data in Bristol to predict the COVID-19
infection rate across Bristol.</p>
<p>The study region is Bristol city, which is partitioned into 55
neighbourhoods at the Middle Layer Super Output Area (MSOA) scale. The
shapefile of the study region <code>shape</code> is a
<code>SpatialPolygonsDataFrame</code>, which is used to map the data. It
stores the location, shape and attributes of geographic features for the
neighbourhoods.</p>
<p>We first load INLA and then retrieve the data from the fdmr example
data store. We’ll use <code>retrieve_tutorial_data</code> to do
this.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">INLA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: sp</span></span></code></pre>
<pre><code><span><span class="co">## This is INLA_23.11.15 built 2023-11-15 19:10:15 UTC.</span></span>
<span><span class="co">##  - See www.r-inla.org/contact-us for how to get help.</span></span>
<span><span class="co">##  - List available models/likelihoods/etc with inla.list.models()</span></span>
<span><span class="co">##  - Use inla.doc(&lt;NAME&gt;) to access documentation</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/retrieve_tutorial_data.html">retrieve_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Tutorial data extracted to  /home/runner/fdmr/tutorial_data/priors</span></span></code></pre>
<p>Next we’ll use the <code>load_tutorial_data</code> function to load
in the spatial data we want.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_data</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"spatial_dataBris.rds"</span><span class="op">)</span></span></code></pre></div>
<p>Now we make a map of the study region.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_data</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">mapp</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">domain</span> <span class="op">&lt;-</span> <span class="va">sp_data</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">mapp</span></span>
<span><span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_map.html">plot_map</a></span><span class="op">(</span>polygon_data <span class="op">=</span> <span class="va">sp_data</span>, domain <span class="op">=</span> <span class="va">domain</span>, add_scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, polygon_fill_opacity <span class="op">=</span> <span class="fl">0.5</span>, palette <span class="op">=</span> <span class="st">"YlOrRd"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-799c7b00c0fd9f8f18d8" style="width:768px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-799c7b00c0fd9f8f18d8">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Satellite",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addLegend","args":[{"colors":["#FD8D3C , #FD8D3C NaN%, #FD8D3C "],"labels":["0"],"na_color":null,"na_label":"NA","opacity":0.8,"position":"topright","type":"numeric","title":null,"extra":{"p_1":null,"p_n":null},"layerId":null,"className":"info legend","group":null}]},{"method":"addPolygons","args":[[[[{"lng":[-2.615827019355336,-2.615154398317955,-2.62440863321484,-2.637677757785846,-2.639578492618356,-2.647202361729409,-2.59576076290588,-2.615827019355336],"lat":[51.50233483372034,51.50460140911316,51.5002879739036,51.500116687389,51.50184143925624,51.51217162919404,51.51535208186618,51.50233483372034]}]],[[{"lng":[-2.587727070512681,-2.599985503987564,-2.601584350735889,-2.615093911634744,-2.616483622949237,-2.615827019355336,-2.59576076290588,-2.580987146367259,-2.582973878509347,-2.59122123714144,-2.587727070512681],"lat":[51.50353278029257,51.49563255472548,51.49919513425576,51.49593753032631,51.49930483917639,51.50233483372034,51.51535208186618,51.51740983388559,51.51301293837257,51.50968340578086,51.50353278029257]}]],[[{"lng":[-2.647202361729409,-2.639578492618356,-2.65086154451761,-2.65743628702034,-2.663304242872616,-2.672487374167925,-2.671483136260649,-2.684722022541575,-2.683606819532829,-2.694679389437621,-2.683760149584889,-2.689155064106536,-2.67589521474873,-2.682593990942056,-2.673808792599258,-2.663683836041886,-2.665420209839934,-2.651399512655531,-2.65448334347852,-2.647202361729409],"lat":[51.51217162919404,51.50184143925624,51.49848934436883,51.50048076629881,51.4911806940429,51.48893710410535,51.49099155527967,51.49610454036305,51.50244114019549,51.50589158609702,51.51075747361671,51.52163268347772,51.53138478879264,51.53517786733045,51.54443267784539,51.53699780874997,51.53096728354933,51.5207057094311,51.51372541372429,51.51217162919404]}]],[[{"lng":[-2.580468770390119,-2.578219389948208,-2.582309184755335,-2.588466181962975,-2.584849829167544,-2.590574754359776,-2.603622641398191,-2.599985503987564,-2.587727070512681,-2.588148516422164,-2.580468770390119],"lat":[51.50097854207899,51.49633563024767,51.49421879565524,51.49057634561533,51.48881864491731,51.48795056185204,51.49274303478537,51.49563255472548,51.50353278029257,51.50123610012915,51.50097854207899]}]],[[{"lng":[-2.567345927814611,-2.564787878650039,-2.567866638003679,-2.572578313174293,-2.582309184755335,-2.578219389948208,-2.580468770390119,-2.567345927814611],"lat":[51.49874904892111,51.49551831279183,51.48933370991042,51.48949299741465,51.49421879565524,51.49633563024767,51.50097854207899,51.49874904892111]}]],[[{"lng":[-2.599985503987564,-2.603622641398191,-2.612199741096872,-2.606732395179901,-2.612793911629732,-2.616269145465788,-2.621417088041612,-2.624579517657554,-2.616483622949237,-2.615093911634744,-2.601584350735889,-2.599985503987564],"lat":[51.49563255472548,51.49274303478537,51.49236952184717,51.49028367065814,51.4838082154032,51.4844442179948,51.49545909338219,51.49497472611998,51.49930483917639,51.49593753032631,51.49919513425576,51.49563255472548]}]],[[{"lng":[-2.637677757785846,-2.638024752712963,-2.652620404303915,-2.662845764067714,-2.663304242872616,-2.65743628702034,-2.65086154451761,-2.639578492618356,-2.637677757785846],"lat":[51.500116687389,51.49236052049542,51.47920735447588,51.48671799686642,51.4911806940429,51.50048076629881,51.49848934436883,51.50184143925624,51.500116687389]}]],[[{"lng":[-2.727429656062688,-2.728398626097164,-2.723441541719047,-2.727429656062688],"lat":[51.49966249708378,51.501795818557,51.5004405016734,51.49966249708378]}],[{"lng":[-2.727721339668665,-2.730353147299598,-2.728559932810636,-2.727721339668665],"lat":[51.49892377648005,51.50233012458044,51.50183991656495,51.49892377648005]}],[{"lng":[-2.728322598685716,-2.727532669941219,-2.727499258992809,-2.728322598685716],"lat":[51.49774967744977,51.49826763860243,51.4981514447794,51.49774967744977]}],[{"lng":[-2.773978241931546,-2.773553755012852,-2.773038454770321,-2.773978241931546],"lat":[51.49430267212723,51.49466292238613,51.49464419432945,51.49430267212723]}],[{"lng":[-2.756070612438284,-2.769774318812082,-2.756700082818981,-2.756070612438284],"lat":[51.49336466198855,51.49452551079762,51.4940492175628,51.49336466198855]}],[{"lng":[-2.731259839868536,-2.735589569024033,-2.734235480131145,-2.731259839868536],"lat":[51.49293715796711,51.49298387942244,51.49387202276633,51.49293715796711]}],[{"lng":[-2.731192507396789,-2.751232923102004,-2.731259839868536,-2.731192507396789],"lat":[51.49291600246624,51.49295452841083,51.49293715796711,51.49291600246624]}],[{"lng":[-2.675734029338356,-2.69218420312451,-2.70947845065862,-2.718213302067745,-2.714138240963581,-2.701029908754238,-2.700288355161002,-2.69521343023089,-2.682690426132339,-2.682593990942056,-2.67589521474873,-2.689155064106536,-2.683760149584889,-2.694679389437621,-2.683606819532829,-2.684722022541575,-2.671483136260649,-2.672487374167925,-2.663304242872616,-2.662845764067714,-2.668369297368665,-2.675734029338356],"lat":[51.48094405981325,51.4895337023534,51.49852367774756,51.5082415637067,51.50758579521877,51.51682363650229,51.51734607714343,51.52245844062898,51.53508072685806,51.53517786733045,51.53138478879264,51.52163268347772,51.51075747361671,51.50589158609702,51.50244114019549,51.49610454036305,51.49099155527967,51.48893710410535,51.4911806940429,51.48671799686642,51.48132226922193,51.48094405981325]}],[{"lng":[-2.684845941939904,-2.697013265822296,-2.693536847771035,-2.692381992713845,-2.689922281041075,-2.687561481688985,-2.68449647450893,-2.684845941939904],"lat":[51.4806703982845,51.4899987783542,51.48832733487922,51.48743093010442,51.48552153845238,51.48377122706344,51.48219217053009,51.4806703982845]}]],[[{"lng":[-2.615827019355336,-2.616483622949237,-2.624579517657554,-2.621417088041612,-2.616269145465788,-2.617127139755149,-2.628967427269694,-2.638024752712963,-2.637677757785846,-2.62440863321484,-2.615154398317955,-2.615827019355336],"lat":[51.50233483372034,51.49930483917639,51.49497472611998,51.49545909338219,51.4844442179948,51.47951293887449,51.4839114071199,51.49236052049542,51.500116687389,51.5002879739036,51.50460140911316,51.50233483372034]}]],[[{"lng":[-2.572578313174293,-2.571148259062861,-2.578154500989361,-2.576497865315101,-2.591515144786578,-2.590574754359776,-2.584849829167544,-2.588466181962975,-2.582309184755335,-2.572578313174293],"lat":[51.48949299741465,51.48408150981805,51.48379426746991,51.48055227458423,51.48730164521763,51.48795056185204,51.48881864491731,51.49057634561533,51.49421879565524,51.48949299741465]}]],[[{"lng":[-2.590574754359776,-2.591515144786578,-2.600921556235575,-2.606754153504269,-2.612793911629732,-2.606732395179901,-2.612199741096872,-2.603622641398191,-2.590574754359776],"lat":[51.48795056185204,51.48730164521763,51.48262434709143,51.47921980776105,51.4838082154032,51.49028367065814,51.49236952184717,51.49274303478537,51.48795056185204]}]],[[{"lng":[-2.515864871073291,-2.515013251129552,-2.525051214783813,-2.525849629756264,-2.531650722237056,-2.541848018963835,-2.542207020152721,-2.534276603709457,-2.538975985121919,-2.539646614894791,-2.546047940769395,-2.54462972384027,-2.55046439262577,-2.552772351633437,-2.55519519313768,-2.560349248841038,-2.557365381444932,-2.534328895446947,-2.527472047849293,-2.515864871073291],"lat":[51.49386822131083,51.49210278534805,51.48943836727514,51.48214507961107,51.48750607016284,51.48725789644399,51.48292188106155,51.47916715823833,51.48035406849419,51.4769070006346,51.47745214098028,51.48114290670802,51.48269621150483,51.47894280072519,51.48153617763906,51.47863791423249,51.48517455618596,51.49674589756058,51.49265547071172,51.49386822131083]}]],[[{"lng":[-2.51512754085036,-2.515231334949815,-2.521543213272904,-2.525796445429639,-2.536036328246155,-2.534276603709457,-2.542207020152721,-2.541848018963835,-2.531650722237056,-2.525849629756264,-2.525051214783813,-2.515013251129552,-2.510999095585922,-2.516711196672786,-2.51512754085036],"lat":[51.48175986112071,51.48144801596654,51.48168710915497,51.47833853543546,51.47675081259332,51.47916715823833,51.48292188106155,51.48725789644399,51.48750607016284,51.48214507961107,51.48943836727514,51.49210278534805,51.48998662809073,51.48515681204378,51.48175986112071]}]],[[{"lng":[-2.560349248841038,-2.560768912652508,-2.567848404369011,-2.574552354870675,-2.576109796645128,-2.576497865315101,-2.578154500989361,-2.571148259062861,-2.572578313174293,-2.567866638003679,-2.564787878650039,-2.554661221497398,-2.555346854301889,-2.551600833896349,-2.534328895446947,-2.557365381444932,-2.560349248841038],"lat":[51.47863791423249,51.47475083656439,51.46891337236487,51.47343531411762,51.47564591303066,51.48055227458423,51.48379426746991,51.48408150981805,51.48949299741465,51.48933370991042,51.49551831279183,51.49634957407058,51.49268760576035,51.49223421390579,51.49674589756058,51.48517455618596,51.47863791423249]}]],[[{"lng":[-2.617127139755149,-2.615519757166387,-2.620223186081732,-2.631811122933373,-2.634037141220637,-2.65109986029085,-2.652620404303915,-2.638024752712963,-2.628967427269694,-2.617127139755149],"lat":[51.47951293887449,51.47151227111092,51.46609869450641,51.4576177001916,51.46649162414761,51.47363804720631,51.47920735447588,51.49236052049542,51.4839114071199,51.47951293887449]}]],[[{"lng":[-2.576497865315101,-2.576109796645128,-2.580055075776783,-2.585031700394662,-2.599033542098447,-2.600921556235575,-2.591515144786578,-2.576497865315101],"lat":[51.48055227458423,51.47564591303066,51.47687500882569,51.47328784535463,51.47665670933512,51.48262434709143,51.48730164521763,51.48055227458423]}]],[[{"lng":[-2.612793911629732,-2.606754153504269,-2.600921556235575,-2.599033542098447,-2.597478928957135,-2.603931046458109,-2.607696977581083,-2.615519757166387,-2.617127139755149,-2.616269145465788,-2.612793911629732],"lat":[51.4838082154032,51.47921980776105,51.48262434709143,51.47665670933512,51.47364403396477,51.47425663914229,51.47155227884308,51.47151227111092,51.47951293887449,51.4844442179948,51.4838082154032]}]],[[{"lng":[-2.515231334949815,-2.514985028124129,-2.512925951612224,-2.520051110286017,-2.525796445429639,-2.521543213272904,-2.515231334949815],"lat":[51.48144801596654,51.48093542050517,51.46915240871955,51.46918637256339,51.47833853543546,51.48168710915497,51.48144801596654]}]],[[{"lng":[-2.534276603709457,-2.536036328246155,-2.544527352645832,-2.541558062718387,-2.547683153181784,-2.551024632723574,-2.553242814977215,-2.560768912652508,-2.560349248841038,-2.55519519313768,-2.552772351633437,-2.55046439262577,-2.54462972384027,-2.546047940769395,-2.539646614894791,-2.538975985121919,-2.534276603709457],"lat":[51.47916715823833,51.47675081259332,51.47136100767941,51.46582622308528,51.46428463950107,51.46396319098461,51.47297817847485,51.47475083656439,51.47863791423249,51.48153617763906,51.47894280072519,51.48269621150483,51.48114290670802,51.47745214098028,51.4769070006346,51.48035406849419,51.47916715823833]}]],[[{"lng":[-2.576109796645128,-2.574552354870675,-2.591212352289954,-2.593776459519689,-2.604483649032462,-2.607696977581083,-2.603931046458109,-2.597478928957135,-2.599033542098447,-2.585031700394662,-2.580055075776783,-2.576109796645128],"lat":[51.47564591303066,51.47343531411762,51.46703649741328,51.47039354129394,51.47014129965023,51.47155227884308,51.47425663914229,51.47364403396477,51.47665670933512,51.47328784535463,51.47687500882569,51.47564591303066]}]],[[{"lng":[-2.512925951612224,-2.512864269421169,-2.528989911295833,-2.541558062718387,-2.544527352645832,-2.536036328246155,-2.525796445429639,-2.520051110286017,-2.512925951612224],"lat":[51.46915240871955,51.46718041131416,51.46688238478151,51.46582622308528,51.47136100767941,51.47675081259332,51.47833853543546,51.46918637256339,51.46915240871955]}]],[[{"lng":[-2.607696977581083,-2.604483649032462,-2.600436514911485,-2.60216645079843,-2.59532846966182,-2.599981427750703,-2.608685758511769,-2.615519757166387,-2.607696977581083],"lat":[51.47155227884308,51.47014129965023,51.46813749703597,51.46551859636546,51.46440259853907,51.46263023481027,51.46202963410228,51.47151227111092,51.47155227884308]}]],[[{"lng":[-2.567848404369011,-2.570022501962826,-2.579918469449128,-2.586162210261028,-2.590741869692887,-2.591212352289954,-2.574552354870675,-2.567848404369011],"lat":[51.46891337236487,51.46804495861895,51.46190262283395,51.45905563689529,51.45991383262724,51.46703649741328,51.47343531411762,51.46891337236487]}]],[[{"lng":[-2.591212352289954,-2.590741869692887,-2.586162210261028,-2.584583701511365,-2.59143364433342,-2.598106663568388,-2.60127079296671,-2.599981427750703,-2.59532846966182,-2.60216645079843,-2.600436514911485,-2.604483649032462,-2.593776459519689,-2.591212352289954],"lat":[51.46703649741328,51.45991383262724,51.45905563689529,51.45705921384434,51.45709413696392,51.46210614530862,51.46033431269034,51.46263023481027,51.46440259853907,51.46551859636546,51.46813749703597,51.47014129965023,51.47039354129394,51.46703649741328]}]],[[{"lng":[-2.608685758511769,-2.608720757161586,-2.614802716338635,-2.620223186081732,-2.615519757166387,-2.608685758511769],"lat":[51.46202963410228,51.45583001223076,51.45545631667693,51.46609869450641,51.47151227111092,51.46202963410228]}]],[[{"lng":[-2.512148464888403,-2.518852931754502,-2.521268211618322,-2.525827323049218,-2.525762612668232,-2.528989911295833,-2.512864269421169,-2.512148464888403],"lat":[51.46305923841896,51.45653776346949,51.45830839189815,51.45524401307704,51.45871572118959,51.46688238478151,51.46718041131416,51.46305923841896]}]],[[{"lng":[-2.525762612668232,-2.542673859341051,-2.547683153181784,-2.541558062718387,-2.528989911295833,-2.525762612668232],"lat":[51.45871572118959,51.45774027920866,51.46428463950107,51.46582622308528,51.46688238478151,51.45871572118959]}]],[[{"lng":[-2.542673859341051,-2.546829609533424,-2.552051613494262,-2.559442127045001,-2.563047614749033,-2.556337957674054,-2.551024632723574,-2.547683153181784,-2.542673859341051],"lat":[51.45774027920866,51.45462310349113,51.45200099595526,51.45187880987239,51.45766095959245,51.46335762819126,51.46396319098461,51.46428463950107,51.45774027920866]}]],[[{"lng":[-2.614802716338635,-2.613380030295726,-2.621877544884269,-2.62853831523288,-2.631811122933373,-2.620223186081732,-2.614802716338635],"lat":[51.45545631667693,51.45250722666085,51.45184476412343,51.45467925180077,51.4576177001916,51.46609869450641,51.45545631667693]}]],[[{"lng":[-2.584583701511365,-2.584141601407839,-2.58833202077148,-2.591849777624955,-2.591149285198722,-2.598724533046107,-2.620031678205376,-2.625270682081497,-2.615587680634692,-2.60786820910791,-2.608720757161586,-2.608685758511769,-2.599981427750703,-2.60127079296671,-2.598106663568388,-2.59143364433342,-2.584583701511365],"lat":[51.45705921384434,51.45277425935989,51.45485818757688,51.45310339880194,51.44566987885906,51.44585223047272,51.44570046310642,51.45011449197833,51.44788200612416,51.45108553668302,51.45583001223076,51.46202963410228,51.46263023481027,51.46033431269034,51.46210614530862,51.45709413696392,51.45705921384434]}]],[[{"lng":[-2.518852931754502,-2.520632031001589,-2.535606333362769,-2.538880625146915,-2.546829609533424,-2.542673859341051,-2.525762612668232,-2.525827323049218,-2.521268211618322,-2.518852931754502],"lat":[51.45653776346949,51.45105301796433,51.44734237839568,51.4548142672195,51.45462310349113,51.45774027920866,51.45871572118959,51.45524401307704,51.45830839189815,51.45653776346949]}]],[[{"lng":[-2.625270682081497,-2.626545083581982,-2.62853831523288,-2.621877544884269,-2.613380030295726,-2.614802716338635,-2.608720757161586,-2.60786820910791,-2.615587680634692,-2.625270682081497],"lat":[51.45011449197833,51.45037476521199,51.45467925180077,51.45184476412343,51.45250722666085,51.45545631667693,51.45583001223076,51.45108553668302,51.44788200612416,51.45011449197833]}]],[[{"lng":[-2.535606333362769,-2.53860765809825,-2.546725290119863,-2.552023736219484,-2.559718104061183,-2.564447341516975,-2.567329653794832,-2.573198904962144,-2.563956264465793,-2.552051613494262,-2.546829609533424,-2.538880625146915,-2.535606333362769],"lat":[51.44734237839568,51.44660307859494,51.44745961652971,51.43721704960901,51.44466160288515,51.44236441028276,51.44279520078021,51.44327552200517,51.44480399667499,51.45200099595526,51.45462310349113,51.4548142672195,51.44734237839568]}]],[[{"lng":[-2.625270682081497,-2.620031678205376,-2.598724533046107,-2.607050677213434,-2.620481687302163,-2.62442172265885,-2.630290507180466,-2.640081807250709,-2.635114025869632,-2.627002084754253,-2.626545083581982,-2.625270682081497],"lat":[51.45011449197833,51.44570046310642,51.44585223047272,51.44030447597753,51.43664527529123,51.44072904763101,51.43948376258274,51.44045434079464,51.44565115929913,51.44667042655918,51.45037476521199,51.45011449197833]}]],[[{"lng":[-2.573198904962144,-2.567329653794832,-2.577018657657819,-2.581959097186179,-2.590202514012621,-2.587409798362524,-2.580142210166125,-2.573198904962144],"lat":[51.44327552200517,51.44279520078021,51.43744986522341,51.43641460636301,51.43941039613861,51.44292623012599,51.44813987358225,51.44327552200517]}]],[[{"lng":[-2.53860765809825,-2.533083449452049,-2.527418202860601,-2.525419036443413,-2.525342572223471,-2.523210410164716,-2.543952339936685,-2.546940986727559,-2.552448418231009,-2.552023736219484,-2.546725290119863,-2.53860765809825],"lat":[51.44660307859494,51.44552872526356,51.44442661909889,51.43444899114388,51.43412155241037,51.42613933384451,51.43062246897185,51.43186150241608,51.43414439773488,51.43721704960901,51.44745961652971,51.44660307859494]}]],[[{"lng":[-2.587409798362524,-2.59977255708375,-2.600702312740619,-2.604504780771225,-2.609560698322638,-2.61634677877245,-2.605980168037199,-2.607050677213434,-2.598724533046107,-2.591149285198722,-2.580142210166125,-2.587409798362524],"lat":[51.44292623012599,51.43740866305062,51.43040724601948,51.42930401369101,51.43175534353752,51.43050772226925,51.43675508768244,51.44030447597753,51.44585223047272,51.44566987885906,51.44813987358225,51.44292623012599]}]],[[{"lng":[-2.581959097186179,-2.590215365528745,-2.597334075695851,-2.600702312740619,-2.59977255708375,-2.587409798362524,-2.590202514012621,-2.581959097186179],"lat":[51.43641460636301,51.43216263272902,51.42844834755248,51.43040724601948,51.43740866305062,51.44292623012599,51.43941039613861,51.43641460636301]}]],[[{"lng":[-2.607050677213434,-2.605980168037199,-2.61634677877245,-2.633927369665114,-2.630290507180466,-2.62442172265885,-2.620481687302163,-2.607050677213434],"lat":[51.44030447597753,51.43675508768244,51.43050772226925,51.42750885036318,51.43948376258274,51.44072904763101,51.43664527529123,51.44030447597753]}]],[[{"lng":[-2.564447341516975,-2.55992416511881,-2.559914173944195,-2.561931413528832,-2.558329880381229,-2.563849953890519,-2.570037712554618,-2.568350346358167,-2.575397372406558,-2.57513012824902,-2.578940089169471,-2.577018657657819,-2.567329653794832,-2.564447341516975],"lat":[51.44236441028276,51.43375556873096,51.43363732217478,51.4303920512129,51.42946416253442,51.4272188585004,51.42636638544325,51.42796825585184,51.42880849151729,51.43558487324526,51.43429974357256,51.43744986522341,51.44279520078021,51.44236441028276]}]],[[{"lng":[-2.552023736219484,-2.552448418231009,-2.546940986727559,-2.543952339936685,-2.523210410164716,-2.531311252965182,-2.529254026059168,-2.533764635057486,-2.547917761095368,-2.558266507346792,-2.558329880381229,-2.561931413528832,-2.559914173944195,-2.55992416511881,-2.564447341516975,-2.559718104061183,-2.552023736219484],"lat":[51.43721704960901,51.43414439773488,51.43186150241608,51.43062246897185,51.42613933384451,51.42331092246596,51.42128097682284,51.41821688682816,51.42753853527861,51.42629322844694,51.42946416253442,51.4303920512129,51.43363732217478,51.43375556873096,51.44236441028276,51.44466160288515,51.43721704960901]}]],[[{"lng":[-2.570037712554618,-2.585237646931465,-2.581759881937812,-2.587858921036897,-2.585783907341157,-2.589977357963037,-2.590215365528745,-2.581959097186179,-2.577018657657819,-2.578940089169471,-2.57513012824902,-2.575397372406558,-2.568350346358167,-2.570037712554618],"lat":[51.42636638544325,51.41950907548527,51.42547715766337,51.42592650261864,51.428385176368,51.42891658615337,51.43216263272902,51.43641460636301,51.43744986522341,51.43429974357256,51.43558487324526,51.42880849151729,51.42796825585184,51.42636638544325]}]],[[{"lng":[-2.585237646931465,-2.593608572217101,-2.594325323812662,-2.595372439170058,-2.603763411826578,-2.604343755060728,-2.604504780771225,-2.600702312740619,-2.597334075695851,-2.590215365528745,-2.589977357963037,-2.585783907341157,-2.587858921036897,-2.581759881937812,-2.585237646931465],"lat":[51.41950907548527,51.41416137646545,51.41384211063586,51.41475537411155,51.42127589941509,51.42612304439233,51.42930401369101,51.43040724601948,51.42844834755248,51.43216263272902,51.42891658615337,51.428385176368,51.42592650261864,51.42547715766337,51.41950907548527]}]],[[{"lng":[-2.604504780771225,-2.604343755060728,-2.614693293366842,-2.619370695203818,-2.624564559335532,-2.629067435789502,-2.632460707340477,-2.637083552023532,-2.633927369665114,-2.61634677877245,-2.609560698322638,-2.604504780771225],"lat":[51.42930401369101,51.42612304439233,51.42083242606143,51.41403387340268,51.41876029573688,51.41603908001313,51.4203475654335,51.42320171094033,51.42750885036318,51.43050772226925,51.43175534353752,51.42930401369101]}]],[[{"lng":[-2.558810924360013,-2.561373011614025,-2.572063900448255,-2.575983856911966,-2.587571090946969,-2.593608572217101,-2.585237646931465,-2.570037712554618,-2.563849953890519,-2.558810924360013],"lat":[51.41123577601659,51.41065616934037,51.41400807317907,51.41080060863632,51.41106208604319,51.41416137646545,51.41950907548527,51.42636638544325,51.4272188585004,51.41123577601659]}]],[[{"lng":[-2.595372439170058,-2.606814940405369,-2.62025381748345,-2.619370695203818,-2.614693293366842,-2.604343755060728,-2.603763411826578,-2.595372439170058],"lat":[51.41475537411155,51.41008474024197,51.41019550252542,51.41403387340268,51.42083242606143,51.42612304439233,51.42127589941509,51.41475537411155]}]],[[{"lng":[-2.533764635057486,-2.534501626056128,-2.543344742561702,-2.558810924360013,-2.563849953890519,-2.558329880381229,-2.558266507346792,-2.547917761095368,-2.533764635057486],"lat":[51.41821688682816,51.41385058752748,51.40741073476475,51.41123577601659,51.4272188585004,51.42946416253442,51.42629322844694,51.42753853527861,51.41821688682816]}]],[[{"lng":[-2.619370695203818,-2.62025381748345,-2.622993234555096,-2.63046531517201,-2.635462063241445,-2.629067435789502,-2.624564559335532,-2.619370695203818],"lat":[51.41403387340268,51.41019550252542,51.40386081037693,51.4021134064629,51.40697876687109,51.41603908001313,51.41876029573688,51.41403387340268]}]],[[{"lng":[-2.594325323812662,-2.594675854655856,-2.602555523186756,-2.610394115377979,-2.622993234555096,-2.62025381748345,-2.606814940405369,-2.595372439170058,-2.594325323812662],"lat":[51.41384211063586,51.41066002477746,51.40985701523643,51.40126730685515,51.40386081037693,51.41019550252542,51.41008474024197,51.41475537411155,51.41384211063586]}]],[[{"lng":[-2.561373011614025,-2.570753572654239,-2.584403152668878,-2.581508013491659,-2.587571090946969,-2.575983856911966,-2.572063900448255,-2.561373011614025],"lat":[51.41065616934037,51.39937121815476,51.40040847264577,51.40883174727633,51.41106208604319,51.41080060863632,51.41400807317907,51.41065616934037]}]],[[{"lng":[-2.587571090946969,-2.581508013491659,-2.584403152668878,-2.590131856654649,-2.610394115377979,-2.602555523186756,-2.594675854655856,-2.594325323812662,-2.593608572217101,-2.587571090946969],"lat":[51.41106208604319,51.40883174727633,51.40040847264577,51.39754697454488,51.40126730685515,51.40985701523643,51.41066002477746,51.41384211063586,51.41416137646545,51.41106208604319]}]],[[{"lng":[-2.563956264465793,-2.573198904962144,-2.580142210166125,-2.591149285198722,-2.591849777624955,-2.58833202077148,-2.584141601407839,-2.584583701511365,-2.586162210261028,-2.579918469449128,-2.573790586369168,-2.575614735245832,-2.567323028694216,-2.570812627064761,-2.568846932383643,-2.563956264465793],"lat":[51.44480399667499,51.44327552200517,51.44813987358225,51.44566987885906,51.45310339880194,51.45485818757688,51.45277425935989,51.45705921384434,51.45905563689529,51.46190262283395,51.45831216050576,51.45521824094079,51.45410708639141,51.44976459825315,51.44516613656901,51.44480399667499]}]],[[{"lng":[-2.556337957674054,-2.563047614749033,-2.572419802007217,-2.570022501962826,-2.567848404369011,-2.563834390018307,-2.558931253760739,-2.556337957674054],"lat":[51.46335762819126,51.45766095959245,51.45945028891783,51.46804495861895,51.46891337236487,51.46348699939663,51.46565128828575,51.46335762819126]}]],[[{"lng":[-2.563047614749033,-2.559442127045001,-2.552051613494262,-2.563956264465793,-2.568846932383643,-2.570812627064761,-2.567323028694216,-2.575614735245832,-2.573790586369168,-2.579918469449128,-2.570022501962826,-2.572419802007217,-2.563047614749033],"lat":[51.45766095959245,51.45187880987239,51.45200099595526,51.44480399667499,51.44516613656901,51.44976459825315,51.45410708639141,51.45521824094079,51.45831216050576,51.46190262283395,51.46804495861895,51.45945028891783,51.45766095959245]}]],[[{"lng":[-2.551024632723574,-2.556337957674054,-2.558931253760739,-2.563834390018307,-2.567848404369011,-2.560768912652508,-2.553242814977215,-2.551024632723574],"lat":[51.46396319098461,51.46335762819126,51.46565128828575,51.46348699939663,51.46891337236487,51.47475083656439,51.47297817847485,51.46396319098461]}]]],null,"Poly",{"interactive":true,"className":"","stroke":true,"color":"grey","weight":1,"opacity":0.5,"fill":true,"fillColor":["#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C","#FD8D3C"],"fillOpacity":0.5,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["OSM","Satellite"],"Poly",{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]}],"limits":{"lat":[51.39754697454488,51.54443267784539],"lng":[-2.773978241931546,-2.510999095585922]}},"evals":[],"jsHooks":[]}</script><p class="caption">
A map of the study region.
</p>
</div>
<p>The COVID-19 data in Bristol are included in our tutorial data
package. We’ll load in the data using same process we used above</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid19_data</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"covid19_dataBris.rds"</span><span class="op">)</span></span></code></pre></div>
<p>Then the first 6 rows of the data set can be viewed using the
following code</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           UtlaName       date week  MSOA11CD cases Population  prevalence</span></span>
<span><span class="co">## 3 Bristol, City of 2021-12-25    1 E02003014    89       8292 0.010733237</span></span>
<span><span class="co">## 4 Bristol, City of 2021-12-25    1 E02003015    99       6692 0.014793784</span></span>
<span><span class="co">## 5 Bristol, City of 2021-12-25    1 E02003016    99       8169 0.012118986</span></span>
<span><span class="co">## 6 Bristol, City of 2021-12-25    1 E02003017    74       6118 0.012095456</span></span>
<span><span class="co">## 7 Bristol, City of 2021-12-25    1 E02003018    69       5870 0.011754685</span></span>
<span><span class="co">## 9 Bristol, City of 2021-12-25    1 E02003020    55       6416 0.008572319</span></span>
<span><span class="co">##       LONG      LAT</span></span>
<span><span class="co">## 3 -2.66729 51.51507</span></span>
<span><span class="co">## 4 -2.59093 51.49491</span></span>
<span><span class="co">## 5 -2.57357 51.49471</span></span>
<span><span class="co">## 6 -2.61209 51.48767</span></span>
<span><span class="co">## 7 -2.65070 51.48954</span></span>
<span><span class="co">## 9 -2.62725 51.49219</span></span></code></pre>
<p>The response variable “cases” in this study is the weekly reported
number of COVID-19 cases in each MSOA in Bristol over the period from
2021-12-25 to 2022-03-26. “prevalence” is the observed COVID-19
infection rate, computed as the ratio of “cases” to “Population” in each
MSOA. We use a Bayesian hierarchical model to predict the
spatio-temporal COVID-19 infection rate at the MSOA level in Bristol. As
the response variable is a count the data likelihood model commonly used
is a Poisson model.</p>
</div>
<div class="section level2">
<h2 id="model-specification">Model specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h2>
<p>Let <span class="math inline">\(Y_{it}\)</span> denotes the weekly
number of reported COVID cases for neighbourhood <span class="math inline">\(i=1,\ldots, n(=55)\)</span> and week <span class="math inline">\(t=1,\ldots, T(=14)\)</span> and <span class="math inline">\(N_{it}\)</span> denotes the (official) estimated
population living in neighbourhood <span class="math inline">\(i\)</span> and week <span class="math inline">\(t\)</span>. <span class="math inline">\(Y_{it}\)</span> is assumed to have a Poisson
distribution with parameters (<span class="math inline">\(N_{it}\)</span>, <span class="math inline">\(\theta_{it}\)</span>), where <span class="math inline">\(\theta_{it}\)</span> is the true unobserved
COVID-19 infection rate / risk in neighbourhood <span class="math inline">\(i\)</span> and week <span class="math inline">\(t\)</span>. We follow a standard path in modelling
<span class="math inline">\(\theta_{it}\)</span> with a log link to the
Poisson and start with a model where the linear predictor decomposes
additively into a set of covariates and a Gaussian latent process
characterizing the infection of the disease after the covariate effects
have been accounted for. The proposed model is given by</p>
<p><span class="math display">\[\begin{align}
\nonumber  Y_{it}\vert N_{it}, \theta_{it} &amp;\sim
\text{Poisson}(N_{it}\theta_{it}),\ \  i=1,\ldots,n;\ \  t=1,\ldots,T,\\
log(\theta_{it}
)&amp;=\boldsymbol{x_{it}^{\top}}\boldsymbol{\beta}+S(i,t).
\end{align}\]</span></p>
<p>A vector of covariates (if needed) is given by <span class="math inline">\(\boldsymbol{x_{it}}\)</span> for neighbourhood
<span class="math inline">\(i\)</span> and time period <span class="math inline">\(t\)</span>. <span class="math inline">\(\boldsymbol\beta\)</span> is a vector of
regression parameters. <span class="math inline">\(S(i,t)\)</span> is a
spatio-temporal random effect at location <span class="math inline">\(i\)</span> and time <span class="math inline">\(t\)</span>, which is modelled by</p>
<p><span class="math display">\[S(i,t)=\alpha \times
S(i,t-1)+\omega(i,t).\]</span></p>
<p>Here <span class="math inline">\(S(i,t)\)</span> follows a stationary
distribution of a first-order autoregressive process (AR(1)) and <span class="math inline">\(\alpha\)</span> is the temporal dependence
parameter that takes on a value in the interval [-1,1], with <span class="math inline">\(\alpha=1\)</span> indicating strong temporal
dependence (a first-order random walk), while <span class="math inline">\(\alpha=0\)</span> corresponds to independence
across time. <span class="math inline">\(\omega(i,t)\)</span> is a
spatial random effect that is assumed to arise from a multivariate
normal distribution. Each <span class="math inline">\(\omega(i,t)\)</span> follows a zero-mean Gaussian
field which is assumed to be temporally independent but spatially
dependent at each time period with Matérn covariance function given
by</p>
<p><span class="math display">\[\text{Cov}(\omega(i,t),
\omega(j,t))=\frac{\sigma^2}{2^{\nu-1}\Gamma(\nu)}(\kappa||i-j||)^{\nu}K_{\nu}(\kappa||i-j||),\]</span>
where <span class="math inline">\(K_{\nu}(\cdot)\)</span> is the
modified Bessel function of second kind, and <span class="math inline">\(\Gamma(\nu)\)</span> is the Gamma function. The
Matérn covariance function has three hyperparameters:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\sigma^2\)</span> controls the marginal
variance of the process S(i,t).</li>
<li>
<span class="math inline">\(\kappa\)</span> controls the spatial
correlation range, which can be defined as <span class="math inline">\(\rho=\sqrt{8\nu}/\kappa\)</span>.</li>
<li>
<span class="math inline">\(\nu\)</span> controls the smoothness,
where higher values leads to processes that are more smoother.</li>
</ol>
<p>The model is implemented through the INLA-SPDE approach in R
programming. A few steps are needed before fitting the model:</p>
<ol style="list-style-type: decimal">
<li>Create a triangulated mesh of the study region</li>
<li>Build the SPDE model based on the mesh and set priors for the
spatial parameters</li>
<li>Define how the process evolves over time and set prior for the
temporal parameter</li>
<li>Define the model formula</li>
</ol>
</div>
<div class="section level2">
<h2 id="mesh-construction">Mesh construction<a class="anchor" aria-label="anchor" href="#mesh-construction"></a>
</h2>
<p>To implement the INLA-SPDE approach, it is necessary to discretize
the space by creating a triangulated mesh that establishes a set of
artificial neighbors across the study region. Here we use the
<code><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fmesher::fm_mesh_2d_inla</a></code> to construct our mesh.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sp_data</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>, <span class="st">"LONG"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span></span>
<span><span class="va">max_edge</span> <span class="op">&lt;-</span> <span class="va">initial_range</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu">fmesher</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fm_mesh_2d_inla</a></span><span class="op">(</span></span>
<span>  loc <span class="op">=</span> <span class="va">sp_data</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LONG"</span>, <span class="st">"LAT"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  max.edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">max_edge</span>,</span>
<span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">initial_range</span>, <span class="va">initial_range</span><span class="op">)</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="va">max_edge</span> <span class="op">/</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-the-spde-model-on-the-mesh-and-set-priors-for-the-spatial-parameters">Build the SPDE model on the mesh and set priors for the spatial
parameters<a class="anchor" aria-label="anchor" href="#build-the-spde-model-on-the-mesh-and-set-priors-for-the-spatial-parameters"></a>
</h2>
<p>To fit the spatio-temporal BHM, it is essential to define prior
distributions for the model parameters associated with spatio-temporal
autocorrelation. The choice of priors depends on the specific research
questions, and relies on prior research findings and expert knowledge.
By carefully selecting and specifying priors, we can capture the
uncertainty and prior beliefs about the spatial and temporal patterns of
data. These priors play a crucial role in Bayesian inference, as they
inform the estimation of model parameters and subsequent predictions.
Exploring different priors allows us to assess the sensitivity of the
model results to the choice of prior distributions. This sensitivity
analysis helps us understand the robustness of the conclusions drawn
from the BHM and provides insights into the impact of prior assumptions
on the final inference. Therefore, in this context of a COVID-19 study,
we investigate the influence of varying priors for the spatial and
temporal autocorrelation parameters on the model inference.</p>
<p>We use the INLA::inla.spde2.pcmatern() function to build the SPDE
model and specify Penalised Complexity (PC) priors for the parameters of
the Matérn field. PC priors for the parameters range (<span class="math inline">\(\rho\)</span>) and marginal standard deviation
(<span class="math inline">\(\sigma\)</span>) of the Matérn field are
specified by setting the values of “prior_range”, “ps_range”,
“prior_sigma”, and “pg_sigma” in the relations that P(<span class="math inline">\(\rho\)</span> &lt; prior_range) = ps_range, and
P(<span class="math inline">\(\sigma\)</span> &gt; prior_sigma) =
pg_sigma. The spatial range <span class="math inline">\(\rho\)</span> of
the process is the distance at which the correlation between two values
is close to 0.1. P(<span class="math inline">\(\rho\)</span> &lt;
prior_range) = ps_range indicates that the probability that <span class="math inline">\(\rho\)</span> is smaller than prior_range is
ps_range, and P(<span class="math inline">\(\sigma\)</span> &gt;
prior_sigma) = pg_sigma indicates that the probability that <span class="math inline">\(\sigma\)</span> is larger than prior_sigma is
pg_sigma.</p>
</div>
<div class="section level2">
<h2 id="define-how-the-process-evolves-over-time-and-set-prior-for-the-temporal-parameter">Define how the process evolves over time and set prior for the
temporal parameter<a class="anchor" aria-label="anchor" href="#define-how-the-process-evolves-over-time-and-set-prior-for-the-temporal-parameter"></a>
</h2>
<p>The previous step has specified that in each of the time periods the
spatial locations are linked by the SPDE model. Now we assume that
across time the process evolves according to a first order
autoregressive (AR(1)) process. We specify a PC prior for the temporal
autocorrelation parameter <span class="math inline">\(\alpha\)</span>.
The PC prior for <span class="math inline">\(\alpha\)</span> is
specified by setting the values of “prior_alpha” and “pg_alpha” in the
relations that P(<span class="math inline">\(\alpha\)</span> &gt;
prior_alpha) = pg_alpha, indicating that the probability of <span class="math inline">\(\alpha\)</span> greater than prior_alpha is
pg_alpha.</p>
<p>Now create a dataframe “priors_dat” that contains four different sets
of values of “prior_range”, “ps_range”, “prior_sigma”, “pg_sigma”,
“prior_alpha” and “pg_alpha”. Each row represents a set of priors for
spatio-temporal correlation parameter.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">priors_dat</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  prior_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  ps_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  pg_sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  prior_alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  pg_alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">priors_dat</span><span class="op">$</span><span class="va">ps_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>Now we fit the BHM to the data separately for each set of the priors.
First, we create a wrapper function to do the INLA inference and
prediction.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">INLA_infer</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mesh</span>, <span class="va">prior_range</span>, <span class="va">ps_range</span>,</span>
<span>                       <span class="va">prior_sigma</span>, <span class="va">pg_sigma</span>,</span>
<span>                       <span class="va">prior_ar1</span>, <span class="va">pg_ar1</span>,</span>
<span>                       <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">spde</span> <span class="op">&lt;-</span> <span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.spde2.pcmatern.html" class="external-link">inla.spde2.pcmatern</a></span><span class="op">(</span></span>
<span>    mesh <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>    prior.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prior_range</span>, <span class="va">ps_range</span><span class="op">)</span>,</span>
<span>    prior.sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prior_sigma</span>, <span class="va">pg_sigma</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">alphaprior</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    prior <span class="op">=</span> <span class="st">"pccor1"</span>,</span>
<span>    param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prior_ar1</span>, <span class="va">pg_ar1</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="va">group_index</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">week</span></span>
<span>  <span class="va">n_groups</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">week</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LONG"</span>, <span class="st">"LAT"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">cases</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu">Intercept</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f</a></span><span class="op">(</span></span>
<span>    main <span class="op">=</span> <span class="va">coordinates</span>,</span>
<span>    model <span class="op">=</span> <span class="va">spde</span>,</span>
<span>    group <span class="op">=</span> <span class="va">group_index</span>,</span>
<span>    ngroup <span class="op">=</span> <span class="va">n_groups</span>,</span>
<span>    control.group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      model <span class="op">=</span> <span class="st">"ar1"</span>,</span>
<span>      hyper <span class="op">=</span> <span class="va">alphaprior</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">inlabru_model</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>    data <span class="op">=</span> <span class="va">data</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>    E <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">Population</span>,</span>
<span>    control.family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">fitted.mean.post</span> <span class="op">&lt;-</span> <span class="va">inlabru_model</span><span class="op">$</span><span class="va">summary.fitted.values</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">fitted.sd.post</span> <span class="op">&lt;-</span> <span class="va">inlabru_model</span><span class="op">$</span><span class="va">summary.fitted.values</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">mean.post</span> <span class="op">&lt;-</span> <span class="va">inlabru_model</span><span class="op">$</span><span class="va">summary.random</span><span class="op">$</span><span class="va">f</span><span class="op">$</span><span class="va">mean</span></span>
<span>  <span class="va">sd.post</span> <span class="op">&lt;-</span> <span class="va">inlabru_model</span><span class="op">$</span><span class="va">summary.random</span><span class="op">$</span><span class="va">f</span><span class="op">$</span><span class="va">sd</span></span>
<span>  <span class="va">fixed.mean</span> <span class="op">&lt;-</span> <span class="va">inlabru_model</span><span class="op">$</span><span class="va">summary.fixed</span><span class="op">$</span><span class="va">mean</span></span>
<span>  <span class="va">dic</span> <span class="op">&lt;-</span> <span class="va">inlabru_model</span><span class="op">$</span><span class="va">dic</span><span class="op">$</span><span class="va">dic</span></span>
<span>  <span class="va">pars</span> <span class="op">&lt;-</span> <span class="va">inlabru_model</span><span class="op">$</span><span class="va">marginals.hyperpar</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fitted.mean.post <span class="op">=</span> <span class="va">fitted.mean.post</span>,</span>
<span>    fitted.sd.post <span class="op">=</span> <span class="va">fitted.sd.post</span>,</span>
<span>    mean.post <span class="op">=</span> <span class="va">mean.post</span>,</span>
<span>    sd.post <span class="op">=</span> <span class="va">sd.post</span>,</span>
<span>    fixed.mean <span class="op">=</span> <span class="va">fixed.mean</span>,</span>
<span>    dic <span class="op">=</span> <span class="va">dic</span>,</span>
<span>    pars <span class="op">=</span> <span class="va">pars</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now we fit the model separately for each set of prior values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">INLA_infer</span><span class="op">(</span></span>
<span>  mesh <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>  prior_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  ps_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">ps_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_sigma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  pg_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_sigma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  prior_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_alpha</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  pg_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_alpha</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  data <span class="op">=</span> <span class="va">covid19_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">INLA_infer</span><span class="op">(</span></span>
<span>  mesh <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>  prior_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  ps_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">ps_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_sigma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  pg_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_sigma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  prior_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_alpha</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  pg_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_alpha</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  data <span class="op">=</span> <span class="va">covid19_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">INLA_infer</span><span class="op">(</span></span>
<span>  mesh <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>  prior_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_range</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  ps_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">ps_range</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_sigma</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  pg_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_sigma</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  prior_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_alpha</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  pg_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_alpha</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  data <span class="op">=</span> <span class="va">covid19_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">INLA_infer</span><span class="op">(</span></span>
<span>  mesh <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>  prior_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_range</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  ps_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">ps_range</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_sigma</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  pg_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_sigma</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  prior_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_alpha</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  pg_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_alpha</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  data <span class="op">=</span> <span class="va">covid19_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The model outputs of the four models above are provided in the
tutorial data package so we’ll load that now.</p>
<blockquote>
<p><strong><em>NOTE:</em></strong> If you’ve run the full models above
you don’t need to load in the files below.</p>
</blockquote>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"m1.rds"</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"m2.rds"</span><span class="op">)</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"m3.rds"</span><span class="op">)</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"m4.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-the-posteriors-of-the-parameters-for-different-priors-">Compare the posteriors of the parameters for different priors.<a class="anchor" aria-label="anchor" href="#compare-the-posteriors-of-the-parameters-for-different-priors-"></a>
</h2>
<p>Different prior values result in different model parameter
estimates.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Range for f`</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"range"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.06</span>, <span class="fl">0.3</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Range for f`</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m3</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Range for f`</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m4</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Range for f`</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"set1"</span>, <span class="st">"set2"</span>, <span class="st">"set3"</span>, <span class="st">"set4"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/parrange-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Stdev for f`</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"marginal standard deviation "</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1.45</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Stdev for f`</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m3</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Stdev for f`</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m4</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`Stdev for f`</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"set1"</span>, <span class="st">"set2"</span>, <span class="st">"set3"</span>, <span class="st">"set4"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/parsigma-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`GroupRho for f`</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"AR(1) "</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.99</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">21</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`GroupRho for f`</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m3</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`GroupRho for f`</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">m4</span><span class="op">$</span><span class="va">pars</span><span class="op">$</span><span class="va">`GroupRho for f`</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"set1"</span>, <span class="st">"set2"</span>, <span class="st">"set3"</span>, <span class="st">"set4"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/paralpha-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="compare-the-posterior-estimates-of-covid-19-infection-rates-for-different-priors">Compare the posterior estimates of COVID-19 infection rates for
different priors<a class="anchor" aria-label="anchor" href="#compare-the-posterior-estimates-of-covid-19-infection-rates-for-different-priors"></a>
</h2>
<p>The boxplots and density curves of the estimated COVID-19 infection
rates for each model are shown below. Although the priors are different,
the posterior infection rate estimates among the four models are
similar, indicating the modelling results are robust to the choice of
the priors.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_rate</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"set1"</span> <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">fitted.mean.post</span>,</span>
<span>  <span class="st">"set2"</span> <span class="op">=</span> <span class="va">m2</span><span class="op">$</span><span class="va">fitted.mean.post</span>,</span>
<span>  <span class="st">"set3"</span> <span class="op">=</span> <span class="va">m3</span><span class="op">$</span><span class="va">fitted.mean.post</span>,</span>
<span>  <span class="st">"set4"</span> <span class="op">=</span> <span class="va">m4</span><span class="op">$</span><span class="va">fitted.mean.post</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">post_rate</span>, xlab <span class="op">=</span> <span class="st">"Prior scenario"</span>, ylab <span class="op">=</span> <span class="st">"Rate estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/postrate-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_rate</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"Prior scenario"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"set1"</span>, <span class="st">"set2"</span>, <span class="st">"set3"</span>, <span class="st">"set4"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"Rate estimates"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">m1</span><span class="op">$</span><span class="va">fitted.mean.post</span>, <span class="va">m2</span><span class="op">$</span><span class="va">fitted.mean.post</span>,</span>
<span>    <span class="va">m3</span><span class="op">$</span><span class="va">fitted.mean.post</span>, <span class="va">m4</span><span class="op">$</span><span class="va">fitted.mean.post</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">post_rate</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Rate estimates`</span>, color <span class="op">=</span> <span class="va">`Prior scenario`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/postrate-2.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="compare-the-observed-rates-and-the-estimated-rates-for-different-priors-">Compare the observed rates and the estimated rates for different
priors.<a class="anchor" aria-label="anchor" href="#compare-the-observed-rates-and-the-estimated-rates-for-different-priors-"></a>
</h2>
<p>Here we compare the distribution of the estimated infection rates
with the observed rates for different priors.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pos_obs_rate</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"scenario"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set1"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Prior scenario`</span>,</span>
<span>    <span class="st">"rate"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set1"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Rate estimates`</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="st">"scenario"</span> <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span><span class="op">)</span>, <span class="st">"rate"</span> <span class="op">=</span> <span class="va">covid19_data</span><span class="op">$</span><span class="va">prevalence</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pos_obs_rate</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rate</span>, fill <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pos_obs_rate</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"scenario"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set2"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Prior scenario`</span>,</span>
<span>    <span class="st">"rate"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set2"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Rate estimates`</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="st">"scenario"</span> <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span><span class="op">)</span>, <span class="st">"rate"</span> <span class="op">=</span> <span class="va">covid19_data</span><span class="op">$</span><span class="va">prevalence</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pos_obs_rate</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rate</span>, fill <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pos_obs_rate</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"scenario"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set3"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Prior scenario`</span>,</span>
<span>    <span class="st">"rate"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set3"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Rate estimates`</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="st">"scenario"</span> <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span><span class="op">)</span>, <span class="st">"rate"</span> <span class="op">=</span> <span class="va">covid19_data</span><span class="op">$</span><span class="va">prevalence</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pos_obs_rate</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rate</span>, fill <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">pos_obs_rate</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"scenario"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set4"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Prior scenario`</span>,</span>
<span>    <span class="st">"rate"</span> <span class="op">=</span> <span class="va">post_rate</span><span class="op">[</span><span class="va">post_rate</span><span class="op">$</span><span class="va">`Prior scenario`</span> <span class="op">==</span> <span class="st">"set4"</span>, <span class="op">]</span><span class="op">$</span><span class="va">`Rate estimates`</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="st">"scenario"</span> <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span><span class="op">)</span>, <span class="st">"rate"</span> <span class="op">=</span> <span class="va">covid19_data</span><span class="op">$</span><span class="va">prevalence</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pos_obs_rate</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rate</span>, fill <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre>
<p><img src="priors_files/figure-html/plotfitted-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="compare-the-predicted-mean-fields-for-different-priors">Compare the predicted mean fields for different priors<a class="anchor" aria-label="anchor" href="#compare-the-predicted-mean-fields-for-different-priors"></a>
</h2>
<p>We compare the predicted mean Gaussian random field.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod.proj</span> <span class="op">&lt;-</span> <span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.project.html" class="external-link">inla.mesh.projector</a></span><span class="op">(</span><span class="va">mesh</span><span class="op">)</span></span>
<span><span class="va">xygrid</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">mod.proj</span><span class="op">$</span><span class="va">x</span>, <span class="va">mod.proj</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">Aproj</span> <span class="op">&lt;-</span> <span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.spde.make.A.html" class="external-link">inla.spde.make.A</a></span><span class="op">(</span>mesh <span class="op">=</span> <span class="va">mesh</span>, loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">xygrid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Aproj</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m1</span><span class="op">$</span><span class="va">mean.post</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">mesh</span><span class="op">$</span><span class="va">n</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">summary.fixed</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predfield</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">predfield</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">2.33</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Set1"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Aproj</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m2</span><span class="op">$</span><span class="va">mean.post</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">mesh</span><span class="op">$</span><span class="va">n</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">summary.fixed</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">predfield</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">predfield</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">2.33</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Set2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Aproj</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m3</span><span class="op">$</span><span class="va">mean.post</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">mesh</span><span class="op">$</span><span class="va">n</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m3</span><span class="op">$</span><span class="va">summary.fixed</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">predfield</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">predfield</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">2.33</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Set3"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Aproj</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m4</span><span class="op">$</span><span class="va">mean.post</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">mesh</span><span class="op">$</span><span class="va">n</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m4</span><span class="op">$</span><span class="va">summary.fixed</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predfield</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">xygrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span>
<span><span class="va">g4</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">predfield</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">2.33</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Set4"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span>, <span class="va">g4</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/plotfield-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="compare-the-information-criterion-values-for-different-priors">Compare the information criterion values for different priors<a class="anchor" aria-label="anchor" href="#compare-the-information-criterion-values-for-different-priors"></a>
</h2>
<p>Finally, we compare the Deviance Information Criterion values of the
four models. The model with the second set of priors has a better model
fit than the others because it has the smallest DIC value.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infocri</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span></span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"set1"</span>, <span class="st">"set2"</span>, <span class="st">"set3"</span>, <span class="st">"set4"</span><span class="op">)</span>,</span>
<span>  DIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">dic</span>, <span class="va">m2</span><span class="op">$</span><span class="va">dic</span>, <span class="va">m3</span><span class="op">$</span><span class="va">dic</span>, <span class="va">m4</span><span class="op">$</span><span class="va">dic</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">infocri</span><span class="op">$</span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">infocri</span><span class="op">$</span><span class="va">priors</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">infocri</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">priors</span>, y <span class="op">=</span> <span class="va">DIC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/infocri-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="influence-of-inappropriate-priors-on-model-inference">Influence of inappropriate priors on model inference<a class="anchor" aria-label="anchor" href="#influence-of-inappropriate-priors-on-model-inference"></a>
</h2>
<p>Bayesian inference is influenced by both priors and data. Therefore,
choosing an appropriate prior is crucial for making sensible inferences
for parameters. Now we will demonstrate how inappropriate priors can
impact the model inference. In the four models mentioned above, the
priors for <span class="math inline">\(\rho\)</span>, <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\alpha\)</span> are specified using probabilistic
statements. Now we will consider an extreme scenario where the priors
are set in such a way that the parameters <span class="math inline">\(\rho\)</span> and <span class="math inline">\(\sigma\)</span> take fixed values. This is
achieved by setting <code>ps_range</code> and <code>pg_sigma</code> as
NA, while <code>prior_range</code> and <code>prior_sigma</code> are used
to enforce fixed parameter values.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_range</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">ps_range</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">prior_sigma</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">pg_sigma</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu">INLA_infer</span><span class="op">(</span></span>
<span>  mesh <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>  prior_range <span class="op">=</span> <span class="va">prior_range</span>,</span>
<span>  ps_range <span class="op">=</span> <span class="va">ps_range</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="va">prior_sigma</span>,</span>
<span>  pg_sigma <span class="op">=</span> <span class="va">pg_sigma</span>,</span>
<span>  prior_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_alpha</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  pg_ar1 <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_alpha</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  data <span class="op">=</span> <span class="va">covid19_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong><em>NOTE:</em></strong> If you’ve run the model above you
don’t need to load in the file below.</p>
</blockquote>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"m5.rds"</span><span class="op">)</span></span></code></pre></div>
<p>Now we compare the distribution of the predicted rates from models
m1, m2, m3, m4 and m5.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_rate</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"model"</span> <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m1"</span>, <span class="st">"m2"</span>, <span class="st">"m3"</span>, <span class="st">"m4"</span>, <span class="st">"m5"</span>, <span class="st">"obs"</span><span class="op">)</span>,</span>
<span>    each <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"Infection rate"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">m1</span><span class="op">$</span><span class="va">fitted.mean.post</span>, <span class="va">m2</span><span class="op">$</span><span class="va">fitted.mean.post</span>,</span>
<span>    <span class="va">m3</span><span class="op">$</span><span class="va">fitted.mean.post</span>, <span class="va">m4</span><span class="op">$</span><span class="va">fitted.mean.post</span>,</span>
<span>    <span class="va">m5</span><span class="op">$</span><span class="va">fitted.mean.post</span>,</span>
<span>    <span class="va">covid19_data</span><span class="op">$</span><span class="va">prevalence</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">post_rate</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Infection rate`</span>, color <span class="op">=</span> <span class="va">`model`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/comdist-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The figure indicates that models m1, m2, m3, and m4 demonstrate a
high degree of agreement with the observed infection rates (denoted by
obs) in their predictions. Conversely, model m5 exhibits significant
discrepancies, with its predictions deviating substantially from the
observed data. Then we compare their DIC values and find that model m5
produces the highest DIC value, indicating that it exhibits a poorer
model fit compared to the other models.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infocri</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span></span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m1"</span>, <span class="st">"m2"</span>, <span class="st">"m3"</span>, <span class="st">"m4"</span>, <span class="st">"m5"</span><span class="op">)</span>,</span>
<span>  DIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">dic</span>, <span class="va">m2</span><span class="op">$</span><span class="va">dic</span>, <span class="va">m3</span><span class="op">$</span><span class="va">dic</span>, <span class="va">m4</span><span class="op">$</span><span class="va">dic</span>, <span class="va">m5</span><span class="op">$</span><span class="va">dic</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">infocri</span><span class="op">$</span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">infocri</span><span class="op">$</span><span class="va">priors</span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">infocri</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">priors</span>, y <span class="op">=</span> <span class="va">DIC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/comDIC-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The use of inappropriate priors not only leads to inaccurate
predictions but can also cause INLA to crash during model fitting. For
instance, if we assign a prior of P(<span class="math inline">\(\alpha\)</span> &gt; 0) = 0.3 for <span class="math inline">\(\alpha\)</span>, which suggests that the
probability of <span class="math inline">\(\alpha\)</span> greater than
0 is 0.3, and assign the set4 priors to other parameters, INLA program
will encounter errors when trying to fit the model.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m6</span> <span class="op">&lt;-</span> <span class="fu">INLA_infer</span><span class="op">(</span></span>
<span>  mesh <span class="op">=</span> <span class="va">mesh</span>,</span>
<span>  prior_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_range</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  ps_range <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">ps_range</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">prior_sigma</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  pg_sigma <span class="op">=</span> <span class="va">priors_dat</span><span class="op">$</span><span class="va">pg_sigma</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  prior_ar1 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pg_ar1 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  data <span class="op">=</span> <span class="va">covid19_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Model m6 encounters errors during execution:
<code>*** inla.core.safe: inla.program has crashed.*** Fail to get good enough initial values.</code>
This highlights the importance of specifying appropriate priors for
model parameters, as it directly impacts the model performance. Choosing
suitable priors can help avoid issues like convergence problems and
ensure the stability and accuracy of the model fitting process.</p>
<div class="section level3">
<h3 id="shiny-app">Shiny app<a class="anchor" aria-label="anchor" href="#shiny-app"></a>
</h3>
<p>To investigate the settings of priors interactively we’ve created a
Shiny app that allows the priors to be changed and the outcomes plotted.
We’ll use the data loaded in above and some initial values for the
priors and plot the model ouput within the app.</p>
<p>We’ll create the same mesh as above and pass that into the app.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sp_data</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>, <span class="st">"LONG"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span></span>
<span><span class="va">max_edge</span> <span class="op">&lt;-</span> <span class="va">initial_range</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu">fmesher</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fm_mesh_2d_inla</a></span><span class="op">(</span></span>
<span>  loc <span class="op">=</span> <span class="va">sp_data</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LONG"</span>, <span class="st">"LAT"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  max.edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">max_edge</span>,</span>
<span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">initial_range</span>, <span class="va">initial_range</span><span class="op">)</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="va">max_edge</span> <span class="op">/</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/model_builder.html">model_builder</a></span><span class="op">(</span>spatial_data <span class="op">=</span> <span class="va">sp_data</span>, measurement_data <span class="op">=</span> <span class="va">covid19_data</span>, mesh <span class="op">=</span> <span class="va">mesh</span>, time_variable <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/gareth-j/" class="external-link">Gareth Jones</a>, <a href="https://www.researchgate.net/profile/Xueqing_Yin" class="external-link">Xueqing Yin</a>, <a href="https://mnky9800n.github.io/" class="external-link">John Aiken</a>, Jonathan Bamber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
