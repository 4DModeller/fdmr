<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fdmr">
<title>INLA FAQ • fdmr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="INLA FAQ">
<meta property="og:description" content="fdmr">
<meta property="og:image" content="https://4dmodeller.github.io/fdmr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fdmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="../articles/getting_started.html">Installation</a>
    <a class="dropdown-item" href="../articles/data_preprocessing.html">Data pre-processing</a>
    <a class="dropdown-item" href="../articles/expected_data_structure.html">Expected data structure</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>End to end tutorials</h6>
    <a class="dropdown-item" href="../articles/decision_tree.html">How to choose how to model</a>
    <a class="dropdown-item" href="../articles/simulation_gaussian_data.html">Simulation Tutorial (Gaussian data)</a>
    <a class="dropdown-item" href="../articles/simulation_poisson_data.html">Simulation Tutorial (Poisson data)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Shiny apps</h6>
    <a class="dropdown-item" href="../articles/meshbuilder.html">Mesh building</a>
    <a class="dropdown-item" href="../articles/modelbuilder.html">Model builder</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>In depth tutorials</h6>
    <a class="dropdown-item" href="../articles/covid.html">COVID-19</a>
    <a class="dropdown-item" href="../articles/covid_mcmc.html">COVID-19 MCMC</a>
    <a class="dropdown-item" href="../articles/covid_ST_mcmc.html">COVID-19 MCMC (Space-time)</a>
    <a class="dropdown-item" href="../articles/hydro.html">Hydrology</a>
    <a class="dropdown-item" href="../articles/priors.html">Priors exploration</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>FAQ</h6>
    <a class="dropdown-item" href="../articles/inla_FAQ.html">INLA Crash FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://4dmodeller.github.io/4DM_Hackathon/">Hackathon</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/4DModeller/fdmr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>INLA FAQ</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/4DModeller/fdmr/blob/HEAD/vignettes/inla_FAQ.Rmd" class="external-link"><code>vignettes/inla_FAQ.Rmd</code></a></small>
      <div class="d-none name"><code>inla_FAQ.Rmd</code></div>
    </div>

    
    
<p>There are number of issues that can crop up when running/fitting the
model either using INLA or inlabru. Below we have compiled issues that
we find common but we also recommend asking questions on the <a href="https://groups.google.com/g/r-inla-discussion-group" class="external-link">google groups
forum</a>.</p>
<div class="section level2">
<h2 id="has-the-model-actually-crashed">Has the model actually crashed?<a class="anchor" aria-label="anchor" href="#has-the-model-actually-crashed"></a>
</h2>
<p>Does the model stop running and give error like
<code>inla.inlaprogram.has.crash(): the inla-program exited with an error. …..</code>?
Or does it give other messages but has not actually crashed?</p>
<p>INLA models can take some time to produce solutions and often times
will give messages like “failed to factorize Q”. However this does not
mean the model has completely failed, only that in that iteration it did
not complete it’s task. Allow the model to run as long as it needs or
returns a crash message.</p>
</div>
<div class="section level2">
<h2 id="are-you-running-the-model-in-verbose-mode">Are you running the model in verbose mode?<a class="anchor" aria-label="anchor" href="#are-you-running-the-model-in-verbose-mode"></a>
</h2>
<p>The model can be run in verbose mode so that it outputs feedback.
This feedback can be useful for diagnosing issues. Running in verbose
mode is done like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.mod</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="va">XX</span>,</span>
<span>  family <span class="op">=</span> <span class="va">XX</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="memory-issues">Memory issues<a class="anchor" aria-label="anchor" href="#memory-issues"></a>
</h2>
<ul>
<li>How large is your data set?</li>
<li>How many mesh nodes? Is the mesh well designed (e.g., no isolated
triangles)?</li>
<li>Have you tried reducing the number of mesh nodes and testing which
mesh size avoids errors?</li>
</ul>
</div>
<div class="section level2">
<h2 id="inla-modeclassic-or-inla-modeexperimental">
<code>inla.mode="classic"</code> or
<code>inla.mode="experimental"</code><a class="anchor" aria-label="anchor" href="#inla-modeclassic-or-inla-modeexperimental"></a>
</h2>
<p><code>inlabru</code> has two modes “classic” and “experimental”. It
is often the case that if you switch the mode then the model will not
crash and you will get a result. To do so, add the parameter either
<code>inla.mode="classic"</code> or
<code>inla.mode="experimental"</code> to the INLAbru call function. So,
it’s something like:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.mod</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="va">XX</span>,</span>
<span>  family <span class="op">=</span> <span class="va">XX</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    inla.mode <span class="op">=</span> <span class="st">"classic"</span>, <span class="co"># or “inla.mode="experimental"</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-many-threads-are-you-using">How many threads are you using?<a class="anchor" aria-label="anchor" href="#how-many-threads-are-you-using"></a>
</h2>
<p>By default, <code>inlabru</code> will use however many threads are
available. However this can cause issues. You can limit the number of
threads with <code>num.threads</code>, by setting
<code>num.threads="1:1"</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.mod</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="va">XX</span>,</span>
<span>  family <span class="op">=</span> <span class="va">XX</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    num.threads <span class="op">=</span> <span class="st">"1:1"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="have-you-selected-reasonable-control-parameters">Have you selected reasonable control parameters?<a class="anchor" aria-label="anchor" href="#have-you-selected-reasonable-control-parameters"></a>
</h2>
<p>INLA has a number options that can be accessed in the fitting formula
using the <code>options</code> parameter. The <a href="https://www.rdocumentation.org/packages/inlabru/versions/2.9.0/topics/bru_options" class="external-link">list
of options</a> is rather large and we encourage you to explore and
experiment with them. Typically this looks something like:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.mod</span> <span class="op">&lt;-</span> <span class="fu">inlabru</span><span class="fu">::</span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="va">XX</span>, family <span class="op">=</span> <span class="va">XX</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    control.inla <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      reordering <span class="op">=</span> <span class="st">"metis"</span>,</span>
<span>      int.strategy <span class="op">=</span> <span class="st">"eb"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="inla-error---linux---failed-to-get-good-enough-initial-values">INLA error - Linux - Failed to get good enough initial values<a class="anchor" aria-label="anchor" href="#inla-error---linux---failed-to-get-good-enough-initial-values"></a>
</h2>
<p>If you’re running Linux and encounter an error similar to the one
below:</p>
<pre><code>.../INLA/INLA/bin/linux/64bit/inla.mkl: /lib64/libm.so.6: version `GLIBC_2.27' not found (required by .../INLA/INLA/bin/linux/64bit/libmvec.so.1)

 *** inla.core.safe:  inla.program has crashed: rerun to get better initial values. try=1/1 
Loading required package: INLA
Warning: package 'INLA' was built under R version 4.3.1
Loading required package: Matrix
Loading required package: sp
This is INLA_23.10.19-1 built 2023-10-19 08:26:30 UTC.
 - See www.r-inla.org/contact-us for how to get help.
 - List available models/likelihoods/etc with inla.list.models()
 - Use inla.doc(&lt;NAME&gt;) to access documentation
Warning in iinla(model = info[["model"]], lhoods = info[["lhoods"]], options = info[["options"]]) :
  iinla: Problem in inla: Error in inla.core.safe(formula = formula, family = family, contrasts = contrasts,  : 
  *** Failed to get good enough initial values. Maybe it is due to something else.</code></pre>
<p>You may need to run a binary install of INLA. This can be done by
running the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/binary.install.html" class="external-link">inla.binary.install</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>For more installation instructions see <a href="https://www.r-inla.org/download-install" class="external-link">the INLA
documentation</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/gareth-j/" class="external-link">Gareth Jones</a>, <a href="https://www.researchgate.net/profile/Xueqing_Yin" class="external-link">Xueqing Yin</a>, <a href="https://mnky9800n.github.io/" class="external-link">John Aiken</a>, Jonathan Bamber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
