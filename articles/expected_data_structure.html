<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fdmr">
<title>Expected data structure • fdmr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Expected data structure">
<meta property="og:description" content="fdmr">
<meta property="og:image" content="https://4dmodeller.github.io/fdmr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fdmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="../articles/getting_started.html">Installation</a>
    <a class="dropdown-item" href="../articles/data_preprocessing.html">Data pre-processing</a>
    <a class="dropdown-item" href="../articles/expected_data_structure.html">Expected data structure</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>End to end tutorials</h6>
    <a class="dropdown-item" href="../articles/decision_tree.html">How to choose how to model</a>
    <a class="dropdown-item" href="../articles/simulation_gaussian_data.html">Simulation Tutorial (Gaussian data)</a>
    <a class="dropdown-item" href="../articles/simulation_poisson_data.html">Simulation Tutorial (Poisson data)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Shiny apps</h6>
    <a class="dropdown-item" href="../articles/meshbuilder.html">Mesh building</a>
    <a class="dropdown-item" href="../articles/modelbuilder.html">Model builder</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>In depth tutorials</h6>
    <a class="dropdown-item" href="../articles/covid.html">COVID-19</a>
    <a class="dropdown-item" href="../articles/covid_mcmc.html">COVID-19 MCMC</a>
    <a class="dropdown-item" href="../articles/covid_ST_mcmc.html">COVID-19 MCMC (Space-time)</a>
    <a class="dropdown-item" href="../articles/hydro.html">Hydrology</a>
    <a class="dropdown-item" href="../articles/priors.html">Priors exploration</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>FAQ</h6>
    <a class="dropdown-item" href="../articles/inla_FAQ.html">INLA Crash FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://4dmodeller.github.io/4DM_Hackathon/">Hackathon</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/4DModeller/fdmr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Expected data structure</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/4DModeller/fdmr/blob/HEAD/vignettes/expected_data_structure.Rmd" class="external-link"><code>vignettes/expected_data_structure.Rmd</code></a></small>
      <div class="d-none name"><code>expected_data_structure.Rmd</code></div>
    </div>

    
    
<p>In this tutorial, we will show the expected data structure for
running the Bayesian Hierarchical Model (BHM) in the <code>fdmr</code>
package. First, let’s have a look at the data structures used in our <a href="https://4dmodeller.github.io/fdmr/articles/covid.html">COVID-19
tutorial</a>, <a href="https://4dmodeller.github.io/fdmr/articles/hydro.html">Hydrology
tutorial</a> and <a href="https://4dmodeller.github.io/fdmr/articles/priors.html">Priors
exploration tutorial</a>.</p>
<p>In the <a href="https://4dmodeller.github.io/fdmr/articles/covid.html">COVID-19
tutorial</a>, we aim to fit a Bayesian spatio-temporal model to predict
the COVID-19 infection rates across mainland England over space and
time, and investigate the impacts of socioeconomic, demographic and
environmental factors on COVID-19 infection. We load the dataset
<code>covid19_data</code> and the type of this object is a
<code>data.frame</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid19_data</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"covid"</span>, filename <span class="op">=</span> <span class="st">"covid19_data.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "data.frame"</span></span></code></pre>
<p>The first 6 rows of the data set can be viewed using the
<code><a href="https://rdrr.io/r/utils/head.html" class="external-link">utils::head()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">covid19_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       MSOA11CD       date week     LONG      LAT cases Population   IMD</span></span>
<span><span class="co">## 6521 E02006663 2020-03-07    1 -1.77072 51.17063     3      12605 12.94</span></span>
<span><span class="co">## 2101 E02002160 2020-03-14    2 -2.07682 52.59541     4       7481 24.79</span></span>
<span><span class="co">## 3321 E02003411 2020-03-14    2 -0.57737 51.52327     8      11443 25.13</span></span>
<span><span class="co">## 4008 E02004108 2020-03-14    2 -1.43761 53.29906     4       7514 17.33</span></span>
<span><span class="co">## 3334 E02003424 2020-03-14    2 -0.71324 51.51317     4       8947  4.58</span></span>
<span><span class="co">## 2094 E02002153 2020-03-14    2 -2.05805 52.61565     3       7217 31.88</span></span>
<span><span class="co">##      carebeds.ratio AandETRUE perc.chinese perc.indian perc.bangladeshi</span></span>
<span><span class="co">## 6521     0.01630534         0    0.2153846   0.5384615       0.02307692</span></span>
<span><span class="co">## 2101     0.01440074         0    0.4223307  18.2922001       0.11878052</span></span>
<span><span class="co">## 3321     0.01265956         1    0.2399232  16.6826615       0.67178503</span></span>
<span><span class="co">## 4008     0.02191863         0    0.1455411   0.2910823       0.10584811</span></span>
<span><span class="co">## 3334     0.02194874         0    1.3427866  10.4952197       0.21484585</span></span>
<span><span class="co">## 2094     0.00000000         0    0.2005884   2.6343942       0.05349024</span></span>
<span><span class="co">##      perc.pakistani   perc.ba    perc.bc  perc.wb      age1     age2     age3</span></span>
<span><span class="co">## 6521      0.0000000 1.2307692 0.35384615 89.54615 11.685839 21.01547 27.10829</span></span>
<span><span class="co">## 2101      0.5807048 1.7949056 1.82130131 63.15164 13.848416 19.51611 25.77196</span></span>
<span><span class="co">## 3321     30.8941139 4.2226488 1.44753679 17.99424 14.812549 23.80495 21.34056</span></span>
<span><span class="co">## 4008      0.2778513 0.1984652 0.07938608 94.98545 11.738089 16.34283 28.81288</span></span>
<span><span class="co">## 3334      4.0068751 1.0849715 0.40820711 61.38146  9.701576 20.73321 27.51760</span></span>
<span><span class="co">## 2094      0.1337256 1.2035304 1.39074619 87.79085 13.759180 16.95996 27.24124</span></span>
<span><span class="co">##          age4     pm25       no2</span></span>
<span><span class="co">## 6521 16.92979 6.608217  5.957610</span></span>
<span><span class="co">## 2101 17.99225 8.066084 14.479405</span></span>
<span><span class="co">## 3321 11.13344 8.308508 14.164620</span></span>
<span><span class="co">## 4008 24.12829 6.813326  8.356319</span></span>
<span><span class="co">## 3334 22.68917 7.822982 11.810846</span></span>
<span><span class="co">## 2094 21.53249 7.715645 12.522200</span></span></code></pre>
<p>You can find that the dataset contains 23 columns. Column
<code>cases</code> is our outcome variable, which is the weekly reported
number of COVID-19 cases in each neighbourhood. Column <code>date</code>
indicates the start date of each observation week when the COVID-19
infections data for each neighbourhood were reported, while column
<code>week</code> indicates the week number that the data were collected
from. Column <code>MSOA11CD</code> represents the neighbourhood code.
Columns <code>LONG</code> and <code>LAT</code> indicate the longitude
and latitude for each neighbourhood. Column <code>Population</code>
indicates the population size. The remaining columns store the data for
our covariates, which are related to the socioeconomic, demographic and
environmental factors. In summary, in this dataset, we have a column for
the outcome variable (<code>cases</code>), a column for the time index
(<code>week</code>, an integer starting at 1), two columns for the
geographical coordinates (<code>LONG</code>, <code>LAT</code>), and a
few columns for the covariates of interest.</p>
<p>Now let’s look at the data structure in the <a href="https://4dmodeller.github.io/fdmr/articles/hydro.html">Hydrology
tutorial</a>. The dataset used here is called <code>inla_data</code>,
which is obtained by using the following codes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/retrieve_tutorial_data.html">retrieve_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"hydro"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Tutorial data extracted to  /home/runner/fdmr/tutorial_data/hydro</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norway_polygon_path</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/get_tutorial_datapath.html">get_tutorial_datapath</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"hydro"</span>, filename <span class="op">=</span> <span class="st">"Kvilldal_Catch_Boundary.geojson"</span><span class="op">)</span></span>
<span><span class="va">norway_polygon</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="va">norway_polygon_path</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_zm.html" class="external-link">st_zm</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sfc</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">norway_polygon</span>, crs <span class="op">=</span> <span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">suldalsvatnet_dam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="fl">6.517174</span>, latitude <span class="op">=</span> <span class="fl">59.490720</span>, label <span class="op">=</span> <span class="st">"Suldalsvatnet Dam"</span><span class="op">)</span></span>
<span><span class="va">stream_gauge_13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="fl">6.5395789</span>, latitude <span class="op">=</span> <span class="fl">59.5815849</span>, label <span class="op">=</span> <span class="st">"Stream Gauge 13"</span><span class="op">)</span></span>
<span><span class="va">stream_gauge_14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="fl">6.7897968</span>, latitude <span class="op">=</span> <span class="fl">59.7531662</span>, label <span class="op">=</span> <span class="st">"Stream Gauge 14"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">streamdata_13</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/get_tutorial_datapath.html">get_tutorial_datapath</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"hydro"</span>, filename <span class="op">=</span> <span class="st">"NVEobservations_s36_13.csv"</span><span class="op">)</span></span>
<span><span class="va">streamdata_14</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/get_tutorial_datapath.html">get_tutorial_datapath</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"hydro"</span>, filename <span class="op">=</span> <span class="st">"NVEobservations_s36_14.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">streamdata_13</span><span class="op">)</span></span>
<span><span class="va">data_13</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">data_13</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">data_13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">data_13</span>, <span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"2021-10-01"</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"2021-10-31"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">data_13</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">data_13</span><span class="op">$</span><span class="va">time_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">31</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">streamdata_14</span><span class="op">)</span></span>
<span><span class="va">data_14</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">data_14</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">data_14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">data_14</span>, <span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"2021-10-01"</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"2021-10-31"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">data_14</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">data_14</span><span class="op">$</span><span class="va">time_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">31</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_13</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data_13</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="va">data_14</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data_14</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">era5_location</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/get_tutorial_datapath.html">get_tutorial_datapath</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"hydro"</span>, filename <span class="op">=</span> <span class="st">"era5_land_daily.nc"</span><span class="op">)</span></span>
<span><span class="va">era5_precip</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">era5_location</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required namespace: ncdf4</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr</span> <span class="op">&lt;-</span> <span class="st">"+proj=utm +zone=32"</span></span>
<span><span class="va">projected_raster</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/projectRaster.html" class="external-link">projectRaster</a></span><span class="op">(</span><span class="va">era5_precip</span>, crs <span class="op">=</span> <span class="va">sr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">era5_precip_cropped</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">projected_raster</span>, <span class="va">norway_polygon</span><span class="op">)</span></span>
<span><span class="va">era5_precip_cropped</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">era5_precip_cropped</span>, <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">norway_polygon</span><span class="op">)</span>, snap <span class="op">=</span> <span class="st">"near"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raster_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterToPoints.html" class="external-link">rasterToPoints</a></span><span class="op">(</span><span class="va">era5_precip_cropped</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raster_df</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">raster_df</span><span class="op">)</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, variable.name <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raster_df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/to_dates.html">to_dates</a></span><span class="op">(</span><span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/numbers_only.html">numbers_only</a></span><span class="op">(</span><span class="va">raster_df</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raster_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">raster_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"time"</span>, <span class="st">"precip"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pixel_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">era5_precip_cropped</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s13_utm</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/latlong_to_utm.html">latlong_to_utm</a></span><span class="op">(</span></span>
<span>  lat <span class="op">=</span> <span class="va">stream_gauge_13</span><span class="op">$</span><span class="va">latitude</span>,</span>
<span>  lon <span class="op">=</span> <span class="va">stream_gauge_13</span><span class="op">$</span><span class="va">longitude</span></span>
<span><span class="op">)</span></span>
<span><span class="va">s14_utm</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/latlong_to_utm.html">latlong_to_utm</a></span><span class="op">(</span></span>
<span>  lat <span class="op">=</span> <span class="va">stream_gauge_14</span><span class="op">$</span><span class="va">latitude</span>,</span>
<span>  lon <span class="op">=</span> <span class="va">stream_gauge_14</span><span class="op">$</span><span class="va">longitude</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">s13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">s13_utm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">s13_utm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">s14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">s14_utm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">s14_utm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pixel_dist_gauge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">pixel_coords</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>  y <span class="op">=</span> <span class="va">pixel_coords</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  dist_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pixel_coords</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  dist_s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pixel_coords</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  min_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pixel_coords</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  streamflow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pixel_coords</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pixel_coords</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">dist_s1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">s13</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">s13</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">dist_s2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">s14</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">s14</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">min_s</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">dist_s1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">dist_s2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">n_time</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/nlayers.html" class="external-link">nlayers</a></span><span class="op">(</span><span class="va">era5_precip</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pixel_dist_gauge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">n_time</span>, <span class="va">pixel_dist_gauge</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_time</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pixel_coords</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">streamdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data_13</span>, <span class="va">data_14</span><span class="op">)</span></span>
<span></span>
<span><span class="va">get_stream_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">which_stream_data</span> <span class="op">&lt;-</span> <span class="va">streamdata</span><span class="op">[[</span><span class="va">row</span><span class="op">[</span><span class="st">"min_s"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">data_at_row_time_index</span> <span class="op">&lt;-</span> <span class="va">which_stream_data</span><span class="op">[</span><span class="va">which_stream_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time_index"</span><span class="op">)</span><span class="op">]</span> <span class="op">==</span> <span class="va">row</span><span class="op">[</span><span class="st">"time"</span><span class="op">]</span>, <span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">data_at_row_time_index</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pixel_dist_gauge</span><span class="op">$</span><span class="va">streamflow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pixel_dist_gauge</span>, <span class="fl">1</span>, <span class="va">get_stream_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inla_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">pixel_dist_gauge</span>, <span class="va">raster_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">inla_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">inla_data</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"streamflow"</span>, <span class="st">"precip"</span>, <span class="st">"time"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The type of the object <code>inla_data</code> is a
<code>data.frame</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">inla_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "data.frame"</span></span></code></pre>
<p>The first 6 rows of the data set are</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">inla_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          x       y streamflow      precip time</span></span>
<span><span class="co">## 1 331417.8 6583370 -0.7379358 0.007305657    1</span></span>
<span><span class="co">## 2 342677.8 6594470 -0.7379358 0.006965242    1</span></span>
<span><span class="co">## 3 348307.8 6594470 -0.7379358 0.006590370    1</span></span>
<span><span class="co">## 4 353937.8 6594470 -0.7379358 0.006557765    1</span></span>
<span><span class="co">## 5 353937.8 6605570 -0.7379358 0.007222239    1</span></span>
<span><span class="co">## 6 359567.8 6594470 -0.7379358 0.006858168    1</span></span></code></pre>
<p>The dataset <code>inla_data</code> contains 5 columns. Column
<code>streamflow</code> is the outcome variable, column
<code>time</code> is the time point index for each data observation.
Columns <code>x</code> and <code>y</code> represent the geographical
coordinates for each observation. Column <code>precip</code> is the
covariate of interest, which is the precipitation data at each location
and time point. Therefore, similar to the <code>covid19_data</code>
dataset, <code>inla_data</code> has a column for the outcome variable
(<code>streamflow</code>), a column for the time index
(<code>time</code>, an integer starting at 1), two columns for the
geographical coordinates (<code>x</code>, <code>y</code>), and a column
for the covariate (<code>precip</code>).</p>
<p>Finally, let’s look at the structure of the dataset used in the <a href="https://4dmodeller.github.io/fdmr/articles/priors.html">Priors
exploration tutorial</a>. In this tutorial, we use the COVID-19 data in
Bristol, UK. We load the dataset <code>covid19_data_bristol</code> and
the object type of it is a <code>data.frame</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/retrieve_tutorial_data.html">retrieve_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Tutorial data extracted to  /home/runner/fdmr/tutorial_data/priors</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid19_data_bristol</span> <span class="op">&lt;-</span> <span class="fu">fdmr</span><span class="fu">::</span><span class="fu"><a href="../reference/load_tutorial_data.html">load_tutorial_data</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"priors"</span>, filename <span class="op">=</span> <span class="st">"covid19_dataBris.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">covid19_data_bristol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "data.frame"</span></span></code></pre>
<p>The first 6 rows of the data set are</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">covid19_data_bristol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           UtlaName       date week  MSOA11CD cases Population  prevalence</span></span>
<span><span class="co">## 3 Bristol, City of 2021-12-25    1 E02003014    89       8292 0.010733237</span></span>
<span><span class="co">## 4 Bristol, City of 2021-12-25    1 E02003015    99       6692 0.014793784</span></span>
<span><span class="co">## 5 Bristol, City of 2021-12-25    1 E02003016    99       8169 0.012118986</span></span>
<span><span class="co">## 6 Bristol, City of 2021-12-25    1 E02003017    74       6118 0.012095456</span></span>
<span><span class="co">## 7 Bristol, City of 2021-12-25    1 E02003018    69       5870 0.011754685</span></span>
<span><span class="co">## 9 Bristol, City of 2021-12-25    1 E02003020    55       6416 0.008572319</span></span>
<span><span class="co">##       LONG      LAT</span></span>
<span><span class="co">## 3 -2.66729 51.51507</span></span>
<span><span class="co">## 4 -2.59093 51.49491</span></span>
<span><span class="co">## 5 -2.57357 51.49471</span></span>
<span><span class="co">## 6 -2.61209 51.48767</span></span>
<span><span class="co">## 7 -2.65070 51.48954</span></span>
<span><span class="co">## 9 -2.62725 51.49219</span></span></code></pre>
<p>The dataset <code>covid19_data_bristol</code> contains 9 columns.
Column <code>cases</code> is the outcome variable, which is the weekly
reported number of COVID-19 cases in each neighbourhood in Bristol.
Column <code>date</code> indicates the start date of each observation
week, while column <code>week</code> indicates the week number that the
data were collected from. Column <code>MSOA11CD</code> represents the
neighbourhood code. Columns <code>LONG</code> and <code>LAT</code>
indicate the longitude and latitude for each neighbourhood. Column
<code>Population</code> indicates the population size. Column
<code>prevalence</code> indicates the infection rate in each
neighbourhood, computed as the ratio of <code>cases</code> to
<code>Population</code>. Likewise, <code>covid19_data_bristol</code> has
a column for the outcome variable (<code>cases</code>), a column for the
time index (<code>week</code>, an integer starting at 1), two columns
for the geographical coordinates (<code>LONG</code>, <code>LAT</code>).
Note that there are no covariate columns because we don’t use any
covariates in this tutorial.</p>
<p>Now we can identify the similarities across the structure of the
datasets <code>covid19_data</code>, <code>inla_data</code> and
<code>covid19_data_bristol</code>. Their object type is a
<code>data.frame</code>, with each row representing a data observation.
The data frame should include a column for the outcome variable, a
column for the time point index, indicating when each observation is
collected, and two columns for the geographical coordinates of each
observation. If the model incorporates covariates, then the covariate
data should also be included in the same data frame, and each covariate
is stored in one column. Users can use any variable names for the
columns, as long as they ensure consistency with those used when
defining the model formula and fitting the BHM. In addition, depending
on the type of outcome data, e.g., Gaussian or Poisson, other variables
may be included in the data frame. For example, in the COVID-19
tutorials where the outcome data follow a Poisson distribution, a
separate column named <code>Population</code> is added to account for
the exposure parameter in the Poisson model. However, in the Hydrology
tutorial where the outcome data are assumed to follow a Gaussian
distribution, there is no need for a column representing the exposure
parameter in the dataset. The following table provides a summary of the
expected data structure for running the BHM in the <code>fdmr</code>
package:</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th>ID</th>
<th>LONG</th>
<th>LAT</th>
<th>Time</th>
<th>Response Variable</th>
<th>Covariate 1</th>
<th>Covariate 2</th>
<th>Covariate…</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>With the expected data object and format, we now possess all the
essential information required for the fitting the BHM. More details
regarding the model fitting process can be found at our <a href="https://4dmodeller.github.io/fdmr/articles">tutorials</a>.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/gareth-j/" class="external-link">Gareth Jones</a>, <a href="https://www.researchgate.net/profile/Xueqing_Yin" class="external-link">Xueqing Yin</a>, <a href="https://mnky9800n.github.io/" class="external-link">John Aiken</a>, Jonathan Bamber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
